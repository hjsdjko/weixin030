(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shop-order-confirm-shop-order-confirm"],{"83fd":function(t,e,r){"use strict";r.r(e);var n=r("daab"),o=r.n(n);for(var a in n)"default"!==a&&function(t){r.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},"9cf4":function(t,e,r){"use strict";var n,o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-uni-view",{staticClass:"content"},[r("v-uni-form",[r("v-uni-view",{staticClass:"cu-form-group"},[r("v-uni-view",{staticClass:"title"},[t._v("购买清单")])],1),t._l(t.orderGoods,(function(e,n){return r("v-uni-view",{key:n,staticClass:"cu-form-group"},[r("v-uni-image",{staticClass:"avator",attrs:{src:t.baseUrl+e.picture,mode:""}}),r("v-uni-view",{staticClass:"title"},[r("v-uni-view",[t._v(t._s(e.goodname))]),1!=t.seat?r("v-uni-view",[t._v("x"+t._s(e.buynumber)),1==t.type||3==t.type?r("v-uni-text",{staticStyle:{"margin-left":"30upx",color:"red"}},[t._v("￥"+t._s(e.total))]):t._e(),2==t.type?r("v-uni-text",{staticStyle:{"margin-left":"30upx",color:"red"}},[t._v(t._s(e.total)+"积分")]):t._e()],1):r("v-uni-view",[t._v(t._s(e.address)+"号"),1==t.type?r("v-uni-text",{staticStyle:{"margin-left":"30upx",color:"red"}},[t._v("￥"+t._s(e.total))]):t._e(),2==t.type?r("v-uni-text",{staticStyle:{"margin-left":"30upx",color:"red"}},[t._v(t._s(e.total)+"积分")]):t._e()],1)],1)],1)})),r("v-uni-view",{staticClass:"cu-form-group"},[1==t.type||3==t.type?r("v-uni-view",{staticClass:"title"},[t._v("总价")]):t._e(),2==t.type?r("v-uni-view",{staticClass:"title"},[t._v("总积分")]):t._e(),r("v-uni-view",[1==t.type||3==t.type?r("v-uni-text",[t._v("￥"+t._s(t.totalPrice))]):t._e(),2==t.type?r("v-uni-text",[t._v(t._s(t.total)+"积分")]):t._e()],1)],1),r("v-uni-view",{staticClass:"cu-form-group"},[t._v("备注"),r("v-uni-input",{staticStyle:{"margin-left":"30upx","border-bottom":"1px solid #999999",height:"60upx","font-size":"28rpx"},attrs:{name:"remark"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1)],2),r("v-uni-view",{staticClass:"padding",staticStyle:{"text-align":"center"}},[1==t.type?r("v-uni-button",{staticClass:"bg-red lg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onSubmitTap()}}},[t._v("确认支付")]):t._e(),2==t.type?r("v-uni-button",{staticClass:"bg-red lg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onSubmitTap()}}},[t._v("确认兑换")]):t._e()],1)],1)},a=[];r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return a})),r.d(e,"a",(function(){return n}))},b1b8:function(t,e,r){"use strict";r.r(e);var n=r("9cf4"),o=r("83fd");for(var a in o)"default"!==a&&function(t){r.d(e,t,(function(){return o[t]}))}(a);r("b638");var s,i=r("f0c5"),u=Object(i["a"])(o["default"],n["b"],n["c"],!1,null,"7522e1c6",null,!1,n["a"],s);e["default"]=u.exports},b638:function(t,e,r){"use strict";var n=r("e09f"),o=r.n(n);o.a},d15e:function(t,e,r){var n=r("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.avator[data-v-7522e1c6]{width:%?150?%;height:%?150?%;margin:%?20?% 0}',""]),t.exports=e},daab:function(t,e,r){"use strict";var n=r("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r("28a5"),r("96cf");var o=n(r("3b8d"));r("c5f6"),r("ac6a");var a={data:function(){return{user:{},orderGoods:{},address:{},total:0,type:1,seat:0,remark:""}},computed:{baseUrl:function(){return this.$base.url},totalPrice:function(){var t=0;return 1==this.seat?t=this.total:this.orderGoods.forEach((function(e){t+=e.price*e.buynumber})),Number(t).toFixed(2)}},onLoad:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.type=e.type,this.seat=e.seat,this.orderGoods=uni.getStorageSync("orderGoods"),1!=this.seat)for(r=0;r<this.orderGoods.length;r++)0==this.total?this.total=parseFloat(this.orderGoods[r].price)*this.orderGoods[r].buynumber:this.total=parseFloat(this.total)+parseFloat(this.orderGoods[r].price)*this.orderGoods[r].buynumber;else this.total=parseFloat(this.orderGoods[0].total),this.address=this.orderGoods[0].address;this.total=this.total.toFixed(2),this.changePrice();case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onShow:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=uni.getStorageSync("nowTable"),t.next=3,this.$api.session(e);case 3:r=t.sent,this.user=r.data;case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{changePrice:function(){var t=this,e=0;this.orderGoods.forEach((function(r){e=1==t.seat?r.total:r.price*r.buynumber,r.total=e.toFixed(2)})),this.$forceUpdate()},onSubmitTap:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this,r=uni.getStorageSync("nowTable"),uni.showModal({title:"提示",content:"是否确认支付",success:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(n){var o,a,s,i,u,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.confirm){t.next=40;break}if(o=e.type,a=!0,s="已支付",1!=o){t.next=8;break}e.user.money-e.total<0&&(e.$utils.msg("余额不足，请先充值"),a=!1,s="未支付"),t.next=13;break;case 8:if(2!=o){t.next=13;break}if(!(e.user.jf-e.total<0)){t.next=13;break}return e.$utils.msg("积分不足，兑换商品失败"),a=!1,t.abrupt("return");case 13:i=0;case 14:if(!(i<e.orderGoods.length)){t.next=26;break}return u={orderid:e.$utils.genTradeNo(),tablename:e.orderGoods[i].tablename,userid:e.user.id,goodid:e.orderGoods[i].goodid,goodname:e.orderGoods[i].goodname,picture:e.orderGoods[i].picture,buynumber:e.orderGoods[i].buynumber,discountprice:e.orderGoods[i].price,price:e.orderGoods[i].price,total:e.orderGoods[i].total,discounttotal:e.orderGoods[i].total,type:o,remark:e.remark,shangjiazhanghao:e.orderGoods[i].shangjiazhanghao,status:s},1==e.seat&&(u["address"]=e.address,c=e.address.split(",").length,u["buynumber"]=c,u["total"]=e.orderGoods[i].total,u["discounttotal"]=e.orderGoods[i].total),t.next=19,e.$api.add("orders",u);case 19:if(!e.orderGoods[i].id){t.next=23;break}return t.next=22,e.$api.del("cart",JSON.stringify([e.orderGoods[i].id]));case 22:uni.removeStorageSync("cart".concat(e.orderGoods[i].goodid).concat(e.user.id));case 23:i++,t.next=14;break;case 26:if(!a){t.next=40;break}if(1!=o){t.next=35;break}return e.$utils.msgBack("支付成功"),e.user.money=Number((Number(e.user.money)-Number(e.totalPrice)).toFixed(2)),(e.user.jf||0==e.user.jf)&&(e.user.jf=Number((Number(e.user.jf)+Number(e.totalPrice)).toFixed(2))),t.next=33,e.$api.update(r,e.user);case 33:t.next=40;break;case 35:if(2!=o){t.next=40;break}return e.$utils.msgBack("兑换成功"),e.user.jf=Number((Number(e.user.jf)-Number(e.totalPrice)).toFixed(2)),t.next=40,e.$api.update(r,e.user);case 40:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()});case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onAddressTap:function(){this.$utils.jump("../shop-address/shop-address")}}};e.default=a},e09f:function(t,e,r){var n=r("d15e");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=r("4f06").default;o("1c591bcc",n,!0,{sourceMap:!1,shadowMode:!1})}}]);